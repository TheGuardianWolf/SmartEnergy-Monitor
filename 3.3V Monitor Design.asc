Version 4
SHEET 1 2372 3036
WIRE 784 -96 -272 -96
WIRE 1408 -48 864 -48
WIRE 480 16 -192 16
WIRE 768 16 480 16
WIRE 960 16 768 16
WIRE 1248 16 960 16
WIRE 848 32 640 32
WIRE 1328 32 1120 32
WIRE 640 48 640 32
WIRE 640 48 592 48
WIRE 688 48 640 48
WIRE 1120 48 1120 32
WIRE 1120 48 1072 48
WIRE 1168 48 1120 48
WIRE 112 64 -96 64
WIRE 304 64 112 64
WIRE 592 64 592 48
WIRE 640 64 640 48
WIRE 688 64 688 48
WIRE 1072 64 1072 48
WIRE 1120 64 1120 48
WIRE 1168 64 1168 48
WIRE 112 96 112 64
WIRE 304 112 304 64
WIRE -96 128 -96 64
WIRE 592 160 592 144
WIRE 640 160 640 128
WIRE 640 160 592 160
WIRE 688 160 688 128
WIRE 688 160 640 160
WIRE 768 160 768 16
WIRE 1072 160 1072 144
WIRE 1120 160 1120 128
WIRE 1120 160 1072 160
WIRE 1168 160 1168 128
WIRE 1168 160 1120 160
WIRE 1248 160 1248 16
WIRE 640 176 640 160
WIRE 736 176 640 176
WIRE 1120 176 1120 160
WIRE 1184 176 1120 176
WIRE 1216 176 1184 176
WIRE -272 192 -272 -96
WIRE 848 192 848 32
WIRE 848 192 800 192
WIRE 864 192 864 -48
WIRE 864 192 848 192
WIRE 1328 192 1328 32
WIRE 1328 192 1280 192
WIRE 304 208 304 192
WIRE 416 208 304 208
WIRE 496 208 496 176
WIRE 496 208 416 208
WIRE 576 208 576 176
WIRE 656 208 576 208
WIRE 704 208 656 208
WIRE 736 208 704 208
WIRE 896 208 832 208
WIRE 976 208 976 176
WIRE 976 208 896 208
WIRE 1056 208 1056 176
WIRE 1136 208 1056 208
WIRE 1216 208 1136 208
WIRE 304 224 304 208
WIRE 496 240 496 208
WIRE 576 240 576 208
WIRE 976 240 976 208
WIRE 1056 240 1056 208
WIRE 112 272 112 256
WIRE 240 272 112 272
WIRE 112 288 112 272
WIRE 112 288 48 288
WIRE 176 288 112 288
WIRE 656 288 656 208
WIRE 656 288 576 288
WIRE 704 288 704 208
WIRE 896 288 896 208
WIRE 1136 288 1136 208
WIRE 1136 288 1056 288
WIRE 1184 288 1184 176
WIRE 1184 288 1152 288
WIRE 1216 288 1184 288
WIRE 416 304 416 208
WIRE 576 304 576 288
WIRE 576 304 528 304
WIRE 624 304 576 304
WIRE 1056 304 1056 288
WIRE 1056 304 1008 304
WIRE 1104 304 1056 304
WIRE 528 320 528 304
WIRE 576 320 576 304
WIRE 624 320 624 304
WIRE 1008 320 1008 304
WIRE 1056 320 1056 304
WIRE 1104 320 1104 304
WIRE 112 368 48 368
WIRE 176 368 112 368
WIRE 1184 368 1152 368
WIRE 1216 368 1184 368
WIRE -96 400 -96 208
WIRE 112 400 112 368
WIRE 112 400 -96 400
WIRE 304 400 304 304
WIRE 304 400 112 400
WIRE 528 416 528 400
WIRE 576 416 576 384
WIRE 576 416 528 416
WIRE 624 416 624 384
WIRE 624 416 576 416
WIRE 896 416 896 352
WIRE 1008 416 1008 400
WIRE 1056 416 1056 384
WIRE 1056 416 1008 416
WIRE 1104 416 1104 384
WIRE 1104 416 1056 416
WIRE 416 432 416 368
WIRE 512 448 -192 448
WIRE 576 448 576 416
WIRE 576 448 512 448
WIRE 992 448 576 448
WIRE 1056 448 1056 416
WIRE 1056 448 992 448
WIRE 240 544 240 272
WIRE 832 544 832 208
WIRE 832 544 240 544
WIRE 1328 592 1328 192
WIRE 1408 592 1328 592
WIRE -272 640 -272 272
WIRE 112 640 112 400
WIRE 112 640 -272 640
WIRE 416 640 416 496
WIRE 416 640 112 640
WIRE 480 640 480 80
WIRE 480 640 416 640
WIRE 512 640 512 512
WIRE 512 640 480 640
WIRE 704 640 704 368
WIRE 704 640 512 640
WIRE 768 640 768 224
WIRE 768 640 704 640
WIRE 896 640 896 480
WIRE 896 640 768 640
WIRE 960 640 960 80
WIRE 960 640 896 640
WIRE 992 640 992 512
WIRE 992 640 960 640
WIRE 1184 640 1184 368
WIRE 1184 640 992 640
WIRE 1248 640 1248 224
WIRE 1248 640 1184 640
WIRE -272 672 -272 640
FLAG -272 672 0
FLAG -192 96 0
FLAG -192 528 0
SYMBOL voltage -96 112 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VL
SYMATTR Value SINE(0 19.8 500)
SYMBOL res 96 160 R0
SYMATTR InstName RL
SYMATTR Value 25R
SYMBOL ind 96 80 R0
SYMATTR InstName LL
SYMATTR Value 3.7m
SYMBOL res 32 272 R0
SYMATTR InstName RS1
SYMATTR Value 1.2R
SYMBOL res 96 272 R0
SYMATTR InstName RS2
SYMATTR Value 1.2R
SYMBOL res 160 272 R0
SYMATTR InstName RS3
SYMATTR Value 1.2R
SYMBOL voltage -272 176 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VC
SYMATTR Value 5V
SYMBOL res 288 96 R0
SYMATTR InstName RD1
SYMATTR Value 100k
SYMBOL res 288 208 R0
SYMATTR InstName RD2
SYMATTR Value 8.2k
SYMBOL res 592 160 R90
WINDOW 0 -7 88 VBottom 2
WINDOW 3 -33 21 VTop 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res 592 224 R90
WINDOW 0 49 91 VBottom 2
WINDOW 3 26 13 VTop 2
SYMATTR InstName R5
SYMATTR Value 1.2Meg
SYMBOL cap 624 64 R0
SYMATTR InstName C1
SYMATTR Value 220p
SYMBOL cap 672 64 R0
SYMATTR InstName C2
SYMATTR Value 68p
SYMBOL res 608 160 R180
WINDOW 0 38 85 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL res 688 272 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL cap 592 384 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value 220p
SYMBOL cap 608 320 R0
SYMATTR InstName C4
SYMATTR Value 68p
SYMBOL res 544 416 R180
WINDOW 0 38 85 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL cap 496 448 R0
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMBOL cap 464 16 R0
SYMATTR InstName C6
SYMATTR Value 0.1µ
SYMBOL Opamps\\opamp2 768 128 R0
SYMATTR InstName U1
SYMATTR Value MCP6021
SYMBOL zener 400 432 R0
SYMATTR InstName D1
SYMATTR Value 1N750
SYMBOL zener 432 368 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value 1N750
SYMBOL res 1088 160 R180
WINDOW 0 38 85 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 1024 416 R180
WINDOW 0 38 85 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R10
SYMATTR Value 100k
SYMBOL cap 944 16 R0
SYMATTR InstName C11
SYMATTR Value 0.1µ
SYMBOL Opamps\\opamp2 1248 128 R0
SYMATTR InstName U2
SYMATTR Value MCP6021
SYMBOL voltage -192 0 R0
SYMATTR InstName V1
SYMATTR Value 3.3V
SYMBOL voltage -192 432 R0
SYMATTR InstName V2
SYMATTR Value 1.65V
SYMBOL cap 976 448 R0
SYMATTR InstName C12
SYMATTR Value 0.1µ
SYMBOL zener 880 416 R0
SYMATTR InstName D3
SYMATTR Value 1N750
SYMBOL zener 912 352 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value 1N750
SYMBOL res 1072 160 R90
WINDOW 0 -7 88 VBottom 2
WINDOW 3 -33 21 VTop 2
SYMATTR InstName R1
SYMATTR Value 22k
SYMBOL res 1072 224 R90
WINDOW 0 49 91 VBottom 2
WINDOW 3 26 13 VTop 2
SYMATTR InstName R2
SYMATTR Value 470k
SYMBOL res 1200 272 R0
SYMATTR InstName R9
SYMATTR Value 22k
SYMBOL res 1136 272 R0
SYMATTR InstName R11
SYMATTR Value 470k
SYMBOL cap 1072 384 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C7
SYMATTR Value 220p
SYMBOL cap 1088 320 R0
SYMATTR InstName C8
SYMATTR Value 68p
SYMBOL cap 1136 128 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C9
SYMATTR Value 220p
SYMBOL cap 1152 64 R0
SYMATTR InstName C10
SYMATTR Value 68p
TEXT 16 280 Left 1 ;Current Shunt
TEXT 16 88 Left 1 ;Load
TEXT 264 320 VLeft 1 ;Voltage Divider
TEXT -264 -112 Left 1 ;+5V Rail
TEXT -136 0 Left 1 ;+3.3V Rail
TEXT -1264 -264 Left 1 !.SUBCKT MCP6021 1 2 3 4 5\n*               | | | | |\n*               | | | | Output\n*               | | | Negative Supply\n*               | | Positive Supply\n*               | Inverting Input\n*               Non-inverting Input\n*\n********************************************************************************\n* Software License Agreement                                                   *\n*                                                                              *\n* The software supplied herewith by Microchip Technology Incorporated (the     *\n* 'Company') is intended and supplied to you, the Company's customer, for use  *\n* soley and exclusively on Microchip products.                                 *\n*                                                                              *\n* The software is owned by the Company and/or its supplier, and is protected   *\n* under applicable copyright laws. All rights are reserved. Any use in         *\n* violation of the foregoing restrictions may subject the user to criminal     *\n* sanctions under applicable laws, as well as to civil liability for the       *\n* breach of the terms and conditions of this license.                          *\n*                                                                              *\n* THIS SOFTWARE IS PROVIDED IN AN 'AS IS' CONDITION. NO WARRANTIES, WHETHER    *\n* EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, IMPLIED        *\n* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE APPLY TO  *\n* THIS SOFTWARE. THE COMPANY SHALL NOT, IN ANY CIRCUMSTANCES, BE LIABLE FOR    *\n* SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.     *\n********************************************************************************\n*\n* The following op-amps are covered by this model:\n*      MCP6021,MCP6021R,MCP6022,MCP6023,MCP6024\n*\n* Revision History:\n*     REV A: 10-Feb-01, KEB (created model)\n*     REV B: 27-Aug-06, HNV (added over temperature, improved output stage, \n*                            fixed overdrive recovery time)\n*                                                   (MC_RQ, 27-Aug-06, Level 1.17)       \n*\n* Recommendations:\n*      Use PSPICE (other simulators may require translation)\n*      For a quick, effective design, use a combination of: data sheet\n*            specs, bench testing, and simulations with this macromodel\n*      For high impedance circuits, set GMIN=100F in the .OPTIONS statement\n*\n* Supported:\n*      Typical performance for temperature range (-40 to 125) degrees Celsius\n*      DC, AC, Transient, and Noise analyses.\n*      Most specs, including: offsets, DC PSRR, DC CMRR, input impedance,\n*            open loop gain, voltage ranges, supply current, ... , etc.\n*      Temperature effects for Ibias, Iquiescent, Iout short circuit \n*            current, Vsat on both rails, Slew Rate vs. Temp and P.S.\n*\n* Not Supported:\n*      Chip select (MCP6023)\n*      Some Variation in specs vs. Power Supply Voltage\n*      Monte Carlo (Vos, Ib), Process variation\n*      Distortion (detailed non-linear behavior)\n*      Behavior outside normal operating region\n*\n* Input Stage\nV10  3 10 -500M\nR10 10 11 690K\nR11 10 12 690K\nG10 10 11 10 11 288U\nG11 10 12 10 12 288U\nC11 11 12 0.2P\nC12  1  0 6.00P\nE12 71 14 POLY(4) 20 0 21 0 26 0 27 0   0 1 1 1 1\nG12 1 0 62 0 1m\nM12 11 14 15 15 NMI\nG13 1 2 62 0 .08m \nM14 12 2 15 15 NMI \nG14 2 0 62 0 1m\nC14  2  0 6.00P\nI15 15 4 225.0U\nV16 16 4 -300M\nGD16 16 1 TABLE {V(16,1)} ((-100,-1p)(0,0)(1m,1u)(2m,1m)) \nV13 3 13 -300M\nGD13 2 13 TABLE {V(2,13)} ((-100,-1p)(0,0)(1m,1u)(2m,1m)) \nR71  1  0 20.0E12\nR72  2  0 20.0E12\nR73  1  2 20.0E12\nI80  1  2 500E-15\n*\n* Noise, PSRR, and CMRR\nI20 21 20 423U\nD20 20  0 DN1\nD21  0 21 DN1\nG26  0 26 POLY(2) 3 0 4 0   0.00 -31.6U -79.4U\nR26 26  0 1\nE271 275 0 1 0 1\nE272 276 0 2 0 1\nR271 275 271 37k\nR272 276 272 37k\nR273 271 0 1k\nR274 272 0 1k\nC271 275 271 3p\nC272 276 272 3p\nG27  0 27 POLY(2) 271 0 272 0  -327U 500U 500U\nR27 27  0 1\n*\n* Open Loop Gain, Slew Rate\nG30  0 30 12 11 1\nR30 30  0 1.00K\nG31 0 31 3 4 4\nI31 0 31 DC 76.9\nR31 31  0 1 TC=2.34M,-4.57U\nGD31 30 0 TABLE {V(30,31)} ((-100,-1n)(0,0)(1m,0.1)(2m,2))\nG32 32 0 3 4 10\nI32 32 0 DC 65\nR32 32  0 1 TC=1.80M,-3.97U\nGD32 0 30 TABLE {V(30,32)} ((-2m,2)(-1m,0.1)(0,0)(100,-1n))\nG33  0 33 30 0 1m\nR33  33 0 1K\nG34  0 34 33 0 1.00\nR34  34 0 1K\nC34  34 0 14U\nG37  0 37 34 0 1m\nR37  37 0 1K\nC37  37 0 6P\nG38  0 38 37 0 1m\nR38  39 0 1K\nL38  38 39 31U\nE38  35 0 38 0 1\nG35 33 0 TABLE {V(35,3)} ((-1,-1n)(0,0)(50.0,1n))(55.0,1))\nG36 33 0 TABLE {V(35,4)} ((-55.0,-1)((-50.0,-1n)(0,0)(1,1n))\n*\n* Output Stage\nR80 50 0 100MEG\nG50 0 50 57 96 2\nR58 57  96 0.50\nR57 57  0 500\nC58  5  0 2.00P\nG57  0 57 POLY(3) 3 0 4 0 35 0   0 0.75M 0.8M 2.00M\nGD55 55 57 TABLE {V(55,57)} ((-2m,-1)(-1m,-1m)(0,0)(10,1n))\nGD56 57 56 TABLE {V(57,56)} ((-2m,-1)(-1m,-1m)(0,0)(10,1n))\nE55 55  0 POLY(2) 3 0 51 0 -1.4M 1 -19.1M\nE56 56  0 POLY(2) 4 0 52 0 3.5M 1 -19.0M\nR51 51 0 1k\nR52 52 0 1k\nGD51 50 51 TABLE {V(50,51)} ((-10,-1n)(0,0)(1m,1m)(2m,1))\nGD52 50 52 TABLE {V(50,52)}  ((-2m,-1)(-1m,-1m)(0,0)(10,1n))\nG53  3  0 POLY(1) 51 0  -50.0U 1M\nG54  0  4 POLY(1) 52 0  -50.0U -1M\n*\n* Current Limit\nG99 96 5 99 0 1\nR98 0 98 1 TC=3.18M,-842N\nG97 0 98 TABLE { V(96,5) } ((-11.0,-23.0M)(-1.00M,-22.7M)(0,0)(1.00M,22.7M)(11.0,23.0M))\nE97 99 0 VALUE { V(98)*((V(3)-V(4))*0.00 + 1.00)}\nD98 4 5 DESD\nD99 5 3 DESD\n*\n* Temperature / Voltage Sensitive IQuiscent\nR61 0 61 1 TC=2.62M,-1.92U\nG61 3 4 61 0 1\nG60 0 61 TABLE {V(3, 4)} \n+ ((0,0)(900M,9.2U)(1.1,50U)(1.3,240U)\n+ (2.1,870U)(2.2,900U)(5.5,980U))\n*\n* Temperature Sensistive offset voltage\nI73 0 70 DC 1uA\nR74 0 70 1 TC=3.5\nE75 1 71 70 0 1 \n*\n* Temp Sensistive IBias\nI62 0 62 DC 1uA\nR62 0 62 REXP  245U\n*\n* Models\n.MODEL NMI NMOS(L=2.00U W=42.0U KP=20.0U LEVEL=1 )\n.MODEL DESD  D   N=1 IS=1.00E-15\n.MODEL DN1 D   IS=1P KF=12.5F AF=1\n.MODEL REXP RES TCE= 9.16\n.ENDS MCP6021
TEXT 480 432 Left 1 ;+1.65V Rail
TEXT -56 -168 Left 2 !.tran 0 10 9 0.01
TEXT 960 432 Left 1 ;+1.65V Rail
TEXT 392 0 Left 1 ;Voltage Signal Processing
TEXT 888 0 Left 1 ;Current Signal Processing
TEXT 1360 -64 Left 1 ;VVOUT
TEXT 1344 576 Left 1 ;VIOUT
RECTANGLE Normal 208 384 16 272 2
RECTANGLE Normal 208 256 16 80 2
RECTANGLE Normal 352 320 256 96 2
RECTANGLE Normal 864 560 384 -16 2
RECTANGLE Normal 1344 560 880 -16 2
